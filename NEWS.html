<pre>
5.0
===
Fetch sort.complexKey from records with most collectionIdentifiers (thereby hiding local variant)
US #biblo:732: missing identifier in briefDisplay
Bug 21618: Remove wrong ERROR log lines
Bug 21617: OS 5.0. getObject kald udleverer pt. ObjectsAvailable info - det skal den ikke
Bug 21615: OpenSearch 5.0 mangler briefDisplay
Bug 21610: Manglende infomedialinks ved getobject mod opensearch 5.0
ini: Add lines for use_holding_block_join and holding_block_join in repository-setting. 
ini: New env @USE_HOLDING_BLOCK_JOIN@ to control use of holding_block_join
ini: Added @NETPUNKT_OPEN_FORMAT@ as open_format uri for netpunkt formats
ini: Removed obsolete universal search section
ini: add repository->default->corepo_get
ini: removed field_unit_id, field_fedora_pid and field_work_id 
agency and profile are now obligatory

4.6
===

4.5 patch 28
====
Records from a deleted library which are still searchable, produced an empty record and make openFormat fails. Added 
some dummy data to make openFormat work

4.5 patch 27
====
Bug 21367 - Nilex 64643: unicode A733 vises forkert i 4.5
Remove random sort from examples

4.5 patch 26
====
Bug fix for sort

4.5 patch 25
====
Remove random sort due to very bad performance

4.5 patch 24
====
Remove unwanted log ERROR lines

4.5 patch 23
====
Add solr timings to STAT log lines

4.5 patch 22
4.3.cloud_patch.16
====
Bugfix 21338 and 21365

4.5 patch 21
====
Skip caching when http-error or empty records from corepo
Add better logging of http-error and empty record from corepo

4.5 patch 20
====
bugfix: getObject http error when fetching empty array

4.5 patch 19
====
Better logging of corepo read errors

4.5 patch 18
4.3.cloud_patch.15
====
Bug 21290 - 4.3 patch 14 og 4.5 patch 17 fejler på søgning med 'and holdingsitem.branch=(* not 'arresten')
Bug 21292 - 4.5. patch 17 og 4.3. patch 14 giver 0 hits ved 'søgning' kun på holdingsitem.agencyId

4.5 patch 17
4.3.cloud_patch.14
====
bugfix: filter on check search

4.5 patch 16
4.3.cloud_patch.13
====
getObject: Ignore collectionIdentifier check when using 870970 as record for "missing" local records

4.5 patch 15
4.3.cloud_patch.12
====
bugz: 21233. Filter local catalog collectionIdentifier with agencyId when holddingsitem.agencyId is used

4.5 patch 14
4.3.cloud_patch.11
====
Handling holdingsitem.agencyId. Modify query and search profile filter

4.5 patch 13
4.3.cloud_patch.10
====
Handling holdingsitem.agencyId as filter or join depending on context. Copy or move solr_query_class.php .php to OLS_class_lib

4.5 patch 12
4.3.cloud_patch.9
====
ini: open_format structure extended to hold an uri to the openFormat web service

4.5 patch 11
====
bug 21084: some calls to openformat fails due to curl pecularities - fixed by using default parameter

4.5 patch 10
4.3.cloud_patch.8
4.2.1.cloud_patch 4
====
AVE mail: handling records in localdata stream for relations

4.5 patch 9
4.3.cloud_patch.7
====
bug 21069: getObject: use record in 870970 localdata stream if library rule says so
ini: add
  action[getObject][] = localIdentifier
  action[getObject][] = agencyAndLocalIdentifier

4.5 patch 8
===
Fix briefDisplay for records in local data stream in 870970-basis records

4.5 patch 7
===
handle empty admindata - mail from d-scrum
new aaa_class.php to OLS_class_lib

4.5 patch 6
===
set trackingId on solr requests and fix to include users trackingId

4.5 patch 5
===
ini: @CACHE_SETTINGS@ and @AGENCY_CACHE_SETTINGS@ in INSTALL file

4.5 patch 4
===
ini: add structure collections_containing_800000

4.5 patch 3
===
search profiles search in 800000-bibdk og 800000-danbib includes records from 870970-basis
bug 20558: When the primary object in the unit is not included by the the search profile, not data for briefDisplay was found

4.5.patch.2
===
Force parenthesis around each AND-node, to fix SOLR problem. BUG: 20957

4.5.patch.1
===
Force parenthesis around each AND-node, to fix SOLR problem. BUG: 20957
ini: remove line: "rank[rank_frequency] = rank_frequency" 
ini: logfile is set from @LOGFILE@
ini: service_location is set from @SERVICE_LOCATION@
docker directory

4.5
===
Bug: 18121. Use 'lend' instead of 'have' in sorting unit's within a work
xsd: Added facetOffset to facet parameter, to allow paging in facets
US 1985: Refactor fetching from corepo in parallel
US 1984: Refactor building of work-strukture from Solr 
ini: remove num_found_collaps_limit and num_found_collapsing_field 
ini: Add field_unit_id, field_fedora_pid and field_work_id 
collapseHitsThreshold parameter is no longer supported. 

4.4
===
US 1949: collections 800000-bibdk and 800000-danbib are automatically filtered against holdindingitem
getObject fetch records if search profile have the collection searchable or is exposed via relations to the collection. Handling getObject on records with relation to collection which is not searched
Changed Content-Type for solr-url's (solr 6.2.0)
bug #20584: getObject will not fetch records which is not part of the search profile. In earlier version, this was a feature, which is hereby removed
US 1937: SOLR cloud: OpenSearch:sharded solr join
US 1937: Different approach for handling join operations on holdingsitems. Revsion 104295 or later
ini: repository: handler_format for holding has changed 
Opensearch "info"-operation - uoverensstemmelse med dokumentation. Sagsnummer 44552
xsd: searchCollectionIsSearched in searchCollection

4.3.cloud_patch.6
====
Bug 21040: remove localdatastream record as candidate, if library rule use_localdata_stream is FALSE

4.3.cloud_patch.5
====
Fix briefDisplay for records in local data stream in 870970-basis records

4.3.cloud_patch.4
====
copy or move aaa_class.php to OLS_class_lib

4.3.cloud_patch.3
====
bug 20558: When the primary object in the unit is not included by the the search profile, not data for briefDisplay was found
Force parenthesis around each AND-node, to fix SOLR problem. BUG: 20957

4.3.cloud_patch.2
====
Bug 20813

4.3.cloud_patch
====
backport US 1937 to version 4.3
move solr_query_class.php to OLS_class_lib
correct handler_format for holding in ini-file according to opensearch.ini_INSTALL example

4.3.patch.1
=====
US 1890: allObjects respects part of query related to holdingsItems

4.3
===
xsd: replaced enumeration types linkToType, accessTypeType and accessType by xs:string - US 1888
ini: in_house_ip_list to remove need for NS lookups - Sagsnummer 40171 
bugfix: handling strings like "aaa \"bbb\" ccc" in cql2tree and parse in solr_query_class
US 1795. Support for 800000-danbib and 800000-bibdk for library-type = forskningsbibliotek
ini: use_sort_complex_key structure - US 1829
US 1829: sortering indenfor værk skal kun bruge sort.complexKey hvis man er bibliotek.dk/danbib
bugfix: briefDisplay took data from first record in unit. Changed to the record cotaining the correct record identifier
ini: Added sort.localAcquisitionDate_ ascending and descending - US 1775
ini: duplicate_request_to structure for test purposes. - US 1862 - revision 98382
ini: remove agency_cache_host, agency_cache_port, agency_cache_expire, agency_timeout, open_agency, agency_search_profile, agency_types, agency_show_order and agency_rules 
ini: new structure agency settings for openAgency operations 
refactor openAgency calls
ini: Added agency_to_collection structure to select the collection corresponding to a given agency
xsd: Added agencyAndLocalIdentifier to getObject operation - US 1804
US 1804 (Iscrum): ORS: Java-OpenOrder: mulighed for at få udleveret pid fra OpenSearch ud fra id+lok

4.2.1 patch.1
============
bug #20491: getObject with more than appr. 80 records fails
US 1870: ini: Sortering på sort.numberInSeries og sort.dateFirstEdition
US 1892: skal kunne udlevere flere relationer med identisk url'er

4.2.1
=====
new rev of class_lib

4.2 patch.3
===========
Limiting acces to records in rawrepo to own records or 870970-records. US 1774: Styring af adgang til poster i RR
ini: added all_rawrepo_agency structure specifying agencies which can read any rawrepo record
?showCqlFile takes repository as argument, like: http://opensearch.addi.dk/4.3/?showCqlFile&repository=prod
?showCqlFile functionality restored. Use correct namespace in explain.xsl and internal function to fetch cql file from solr-server.
Only own and 870970 records can be fetched from rawrepo - US 1774
Records from rawrepo owned by 870970, are fetched with merging 
Removed cql.xml files from svn repository. These files are fetched from solr files

4.2 patch.2
===========
primaryObjectIdentifier was missing in getObject

4.2 patch.1
===========
Retrieving records via relations, defaults to primary_pid - bug: 19628
Records from rawrepo are fetched without merging - bug: 19611
Using first shot on Registry if proper section is set in ini-file and registry server is available - rev 94736
bugfix: reserved characters in queries inside quotes are now escaped - like ( ) and : - rev 94704
ini: added endpoint url (open_agency) for openAgency and set 4 openagency operations (agency_search_profile, agency_types, agency_show_order and agency_rules) as relative to the endpoint
Setting stepValue to 0, now skips some code
Better error handling i rawrepo reading
ini: changed content in missing_marc_record 

4.2
===
ini: added agency_rules
ini: added missing_marc_record - US 1684
added opesearch_explain.xsd to reflect cql.xml-file(s) content
Records from raw repo are now fetched using the raw repo content service - - US 1684
ini: removed postgress as repository parameter and added rawrepo instead. Rawrecords has to be read using the WS (RawRepoContentService) specified in rawrepo - - US 1684
ini: s11_agency defining which agencies that are allowed to see records from RR containing s11 - US 1684
US 1684: RR - poster med S11 felter skal ikke kunne søges af andre end DBC 
Handling  deleted records. parse_unit_for_best_agency() now skips recordStatus = delete
Bugfix: truncation in quoted strings

4.1.1
===
Returning all available pids from unit in objectsAvailable - earlier only one from each collection was returned
Handling of units with more than one 870970-basis object
Handling truncation and masking using ? and * - US 1656

4.1 patch
===
ini: max_facet_threads - defaults to 50
getObject refactored. Fetch municipal or school records from local record or the 870970-basis record if no local record is found. Identifier in result will reflect this.
Raw records library 870970 reads 191919 records and correct 001*b - hack until Raw Record abstracion webservice is made.

4.1
===
log STAT linies have query as last element
Changed logic so works are cut to max 100 (MAX_OBJECTS_IN_WORK) manifestations, after not needed manifestations are removed.
Handle schools (Skolebiblioteker) as part of 870970-skole - US 1620: openSearch skal l&aelig;re af 870970-skole er samle-collection for skolebiblioteker 
Handle school records as data in local datastream of 870970-basis - US 1621: Skolebiblioteksposter kan som folkebiblioteksposter, findes som lokaldatastr&oslash;m i 870970-objektet  
As of revision 85576 search indexes are case insensitive
Added identifiers from local datastream in 870970-basis to objectsAvailable - US 1624
getObject logic concerning municipal records is rewritten to get data from the *-katalog or from localData stream in the 870970-basis object - US 1622
ini: agency_type change from findLibrary to ?action=libraryTypeList&outputType=json&trackingId=%s for openagency 2.19 and later. Handles research-libraries being part of 870970-forsk in search profiles - US 1623
ini: add &trackingId=%s to agency_type, agency_search_profile and agency_show_order 
xsd: objectsAvailable - containing all identifiers in the same unit as the object - US 1624
ini: agency_timeout for setting timeout for openagency calls - defaults to 10 seconds - rev 84146
ini: added &trackingId=%s for agency_search_profile, agency_types and agency_show_order - rev 84142
ini: syslog_id must be set when loggin to syslog - rev. 84032.
ini: set num_found_collaps_limit = 100
ini: _VERSION_ in dump_timer is replaced by version from ini-file - rev 84004
use support for new openAgency call libraryTypeList - openagency 2.19 and later has this operation
fetch cql file from solr file directory. US 1603: opensearch_cql skal distribueres og versioneres sammen med br&oslash;ndens filer. 
xsd: cqlIndex as part of infoRepository. InfoCqlIndexDocs removed.
ini: solr_file_cache_* 
getObject can fecth up to max_manifestations (ini-file setting) records
ini: __COLLECTION_INCLUDE__ on repository handler join operations
Handling search using holdingsItems for collections without holding
Added timer facets like n.mmm, where n is count(facetName) and mmm is numberOfTerms
Use Solr facets.threads to parallelize facets lookups. 
ini: max_manifestations = 200 (used when collectionType equals manifestation)
ini: luke[... renamed to solr_luke[...
ini: added solr_file to get data files from solr
xsd, ini: in searchRequest collapseHitsThreshold will overrule ini file setting num_found_collaps_limit. Since solr collapsing is pretty expensive, some cases will benefit from setting this to 0 (zero). Settings above 1000 is discouraged

4.0.1
===
ini: introducing feature_switch structure for handling repetitive fields in solr-driven formats like briefDisplay
wsdl displayed by http://opensearch...../?wsdl - revision 81585
ini: service_location - used in wsdl of the service
Search profiles and contained_in, to handle collectionIdentifiers that are part of an other collection. Solves 150013-palle problem. - need openagency 2.18 

4.0.patch
===
Bugfix 18344: getObject did not know prioritized library list

4.0
===
xsd: infoGenerel => infoGeneral
xsd: sortUsed added maxOccurs="unbounded"
bugfix: MAX_IDENTICAL_RELATIONS only count valid relations
US 1499: Udlevering af alle ln:links i én unit (fra de kilder man har adgang til) 
ini: dump_timer_ip will add the request ip to the TIMER log lines
US 1477: check for the 870970-basis and 870970-forsk groupings
Object in units are selected respecting a prioritized list of libraries - US 1477
US 1477: Prioriteringsliste for hvilke objekter der skal udleveres fra en unit i stedet for at det altid er prim&aelig;r-objektet der udleveres 
ini: corrected agency_types to libraryType=Alle - US 1477
ini: agency_show_order - need openagency tag 2.17 - US 1477
wsdl, xsd, ini: new operation info. Removed enumerations from xsd, since they are now in infoResponse

3.2 - patch
===
xsd: localIdentifier in getObject as alternative to identifier (for Marc sources)
ini: filter for docbook records equivalent to marcxchange filters
ini: filter in repositories restructured so filtering is set for each owner/source (or in defaults for all)
ini: collection_alias in repository for each owner/source (or in defaults for all) - US 1420
ini: collection_query in repository for each owner/source (or in defaults for all) - US 1420
Collections from the search profile, can be filtered by ini-setting: collection_query.
- US 1420: Materialevurderinger som to forskellige kilder
ini: rank[rank_frequency] replaced by rank_frequency structure - US 1447
US 1447: Rankering: valg mellem en eller flere metoder - using filter, weight and search profile with rank_frequency

3.2
===
xsd: userDefinedBoost
cql: handling string and word as relation modifier on =
xsd: formatsAvailable added minoccurs="0"
ini: introducing sort-groups - US 1376: ... supplerende sortkriterier er fast defineret
Information about the records status is returned for search and getObject. For search it should allways 
  be active - US 1429: Oplysning om status p&aring; en post/datastr&oslash;m n&aring;r man bruger getObject
xsd: added recordStatus (active/delete) to the object structure. 
If the agency has a record of its own, this is selected instead of the primaryBibObject or the commenData stream for
  7xxxxx libraries - US 1427: Udlevering af et biblioteks egen post fra enhedsklynge
xsd: facetMinCount - defaults to 0
xsd: facetSort can contain count (default) or index
ini: rank structure added rank[rank_cql] to handle the relation modifier 'relevant'
cql: handlign relation modifier 'relevant', allowing 'ti any/relevant "some words"' and 'ti=/relevant "some words"'
cql: handling of any-operator. 'ti any "some words"', will search for 'ti:some OR ti:words'
ini: filter on marcxchange records defined in repository structure
US 1358: more than one search argument for the holdings+ solr
US 1354-57: handling search argument for different indexes in holdings+ solr
opensearch_cql: added searchHandler attribute on name-tag to handle different solr searchHandlers
rank_frequency takes frequency_filter from ini-file
ini: frequency_filter
US 1378: Filter private fields from marc records from raw record repository
removed userDefinedBoost
US 1353: removed rank parameter in request. Values can now be specied as part of the sort parameter
US 1353: rankUsed renamed to sortUsed and set to rank or sort used in request
US 1320: Acceptance-test af opensearch webservice brug af r&aring;postrepositorie

3.1
===
ini: repository added functionality for supporting raw records repository 
Raw records repository functionality
bugfix: boolean operator not failed i solr.4.4.0
added new indexes to opensearch_cql - US 1326
Sorting within a work is now done based on sort.complexKey of the primary object - US 1321
xsd: primaryObjectIdentifier added and returned from getObject - US 1316 (US 1263)
ini: added marc21ToDm2 to open_format struct
xsd: added marc21ToDm2 to objectFormatType
ini replace cql_file = ... with  repository[defaults][cql_file] = opensearch_cql.xml making
it possible to have different cql-setting for each repository
ini: fedora[XXX] changed to repository[defaults][fedora_XXX]
introducing worldCat as external target. First step towards using Universal Search
briefDisplay data is fetched from primaryObject - US 1265
Parse full cql US 1216
Remove z3950 possibility

3.0
===
sort.date is integer allowing function sort as map(sort.date,2030,999999,0) for bottoming out invalid years
bug 16977: collections with more than MAX_OBJECTS_IN_WORK manifestations didn't mark (and cache) all manifestations as used
opensearch_cql.xml: hidden attribute on <map>
ini: cql_file = opensearch_cql.xml
function diffCqlFileWithSolr() - US 1178
ini: url_override - US 1178
bugz: 16646
xsd: queryFilter for the filter part of the query
opensearch_cql.xml: alias tags for alternate index names. US 1145
ini: added display.titleFull to solr_format[briefDisplay][format]
xsd: titleFull
ini: [format] section - includes openFormat logic into openSearch
ini: set default_namespace_prefix = os and change xmlns[] to xmlns[os]
xsd: linkCollectionIdentifier
bugfix: work-1
cache keys use config->get_inifile_hash() instead of version
Handling of local data streams: Selecting the proper stream depending on collectionIdentifier. 
Handling of local data streams: Checking resulting record from relations according to the search profile.
ini: new ini-file struct for repository - added fedora structure. 
ini: num_found_collaps_limit and num_found_collapsing_field - will use num_found_collapsing_field when num found is below num_found_collaps_limit
ini: added sort[] for work_type, record_owner and article_date - US #990
xsd: added sortType for work_type, record_owner and article_date - US #990
ini: rank_frequency - US #1079: udvidelse af openbib.dk - rankering
ini: collapsing_field 
unit.id from SOLR can be scalar or array
Bugfix: ((r&oslash;de OR bl&aring;) AND ekspres AND kattler) OR (ekspres AND kattler NOT r&oslash;de) is now parsed correctly
Include external relations (from commonData) for relation-records included when request->relationData equals full #US 983
xsd, getObject: error on object level. If one or more records are deleted/unknown
ini: added relation_group_source_tab
relation: isPartOfManifestation for research-libraries maps to 870970-forsk - #US884
ini: added agency_types url
ini: rename profile_cache_* to agency_cache_*
ini: added xmlns[kml] = http://www.opengis.net/kml/2.2
ini: updated the rank structure to use version 3 registers
ini: rename open_agency to agency_search_profile
queryLanguage: bestMatch US #122
ini: showinfo section
ini: removed relation structure - is now part of the search profile
ini: removed search_profile_version from repository[]
ini: fedora_get_rels_ext renamed to fedora_get_rels_hierarchy in repository structure
ini: delete fedora_get_datastreams from repository structure
ini: Added phrase_index[]
Better (?) cql-2-solr parser
trackingId in reply in statInfo
work-objects containing more than 100 objects is cut to 100 objects
collectionType = work-1 is somewhat broken - it return to much information
sorting of objects within a collection using sort.complexKey
ini: remove all " from inifile settings - these are set by the inifile_class
ini: max_identical_relation_names
ini: holdings_db - url to holdings-service
ini: solr_format with briefDisplay
briefWorkDisplay
dropped work_format in ini-file
created new repository OpenBibdk for
getObject: more than one identifier can be specified
statInfo in result
for collectionType=work-1 return identifier for all object
missing record now gives error: record_not_found
cql: added < > <= >=
allRelations is obsolete
queryLanguage in searchRequest
queryLanguage added to opensearch.xsd
trackingId in logfile and handed to openFormat
drop includeMarcXchange
ini: open_format structure for name mapping
ini: open_format => ws_open_format_uri
objectFormat: one or more of opensearchobject briefDisplayHtml fullDisplayHtml workDisplayHtml briefDisplay fullDisplay refWorks ris
response: debugResult to queryDebugResult
ini: search_profile_version i repository, 2 or 3
ini: openAgency changed to include profileVersion
objectFormat formats the record(s) using openFormat
bugfix in proximity adj operator
search: added includeHoldingsCount and objectFormat
getObject: added includeHoldingsCount and objectFormat
allObject bug fixet

2.3 - branch of 2.2
===
allObject bug fixet

2.2
===
getObject: deleted record return error: 'Error: deleted record RECORD_PID'
fedora_get_object_profile must be set in repository[] in ini-file
work_format in ini-file

2.1
===
Better (correct) cache_key
Caching of fedora objects
collectionType = work-1 will only fetch the first object i each collection
support for adj from cql
Using edismax solely as search handler
Added callback and outputType to getObjectRequest 
In searchRequest agency and profile must both be either set or not

2.0
===
New version of DKABM
relation in ini-file now defines 2 types: 1 = internal relation; 2 = external relation
profile_cache_* in ini-file
agency_fallback and profile_fallback in ini-file
use search profiles specified by openagency
Modified several xsd and made it loadable with soapUI 

1.3
===
Check for valid relations in getObject. If agency and profile is used, only relations to records 
 which can be found, using the supplied profile, will be returned.
Changed opensearch.xsd getObject: added agency and profile
namespace on relationType

1.2
===
profile in request
ensure cql.anyIndexes in dismax-part when userDefinedRanking is used
includeMarcXchange in request and marcx:collection in response

1.1
===
queryDebug
service_http_error in ini-file
escapes : in all search args
dropped fedoraNormPid usage
userDefinedBoost and boostField
repository in request and new ini file structure (repository) for this
opensearchobject
allRelations and relationData on getObject operation
opensearch_cql: added facet: form, acsource, category
new xsd

1.0
===
userDefinedRanking
AvailableFormats
format=dkabm, marcxchage or docbook supported
action getObject
time in seconds in reply
facet.category & facet.acSource
With relations - allRelations and relationData in request controls this

0.14
====
same as 0.13
0.14 points at version 1.0 of the "databroend"

0.13
===
Better cql to dismax
authentication - sofar only IP
dump_timer in ini-file
ranking and searches using " failed

0.12
====
robots.txt_INSTALL
' hack 
ranking (dismax-part) failed on NOT searches

0.11
====
show_samples in ini-file
in_house_domain in ini-file
Retrieve record as rec.id=NNNNNN:nnnnnnn instead of fedoraNormPid=NNNNNN_nnnnnnn
skipCache=1
ranking: rank_general rank_title rank_creator
browser.php - test/verification tool
In rest-url the parameter charset can now specify the charset used in the request, like utf-8 or iso-8859-1. Defaults to utf-8

0.10
====
sort = random - will return stepValue random records within the search result
collectionType supported
Better handling of agency. Use &fileterquery internally instead

0.9
===
Check for valid agancy (if any)
introducing caching using memcache_class
Preread fewer fedorapids from solr and add more if needed
U+A732 and U+A733 convert to Aa and aa on display

0.8
===
fedoraNormPid introduced
allObjects=1 filters against a specified agency
resultPosition now set
skip subject=undefined
raw_index in ini-file

0.7
===
added sort
Added timers
Dropped RISEARCH
Updated all xsd

0.6
===
Moved code to abstract class 
Support for attributes and namespaces

0.4
===
Structure for caching made
Different/alternate approach when making collections
"more" in reply
New xsd describing collections
Work relations found using RIsearch
First try with correct work-collections
allObjects supported
cql to solr conversion

0.3
===
Data from Fedora object store
format rawData and dc

0.2
===
xsd in separate file and changed quite a bit
identifier in dc records

0.1
===
first version

</pre>
